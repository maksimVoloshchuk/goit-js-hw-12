{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '53365045-d30e2460a35774e20f4e732a7';\nconst PER_PAGE = 15;\n\nasync function getImagesByQuery(query, page = 1) {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: PER_PAGE,\n    page,\n  });\n\n  const url = `${BASE_URL}?${params.toString()}`;\n\n  const response = await axios.get(url);\n  return response.data;\n}\n\nexport { getImagesByQuery, PER_PAGE };\nexport default getImagesByQuery;","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst galleryContainer = document.querySelector('.gallery');\nconst loaderEl = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nconst LOADER_ACTIVE_CLASS = 'is-shown';\nconst HIDDEN_CLASS = 'is-hidden';\n\nlet lightboxInstance = null;\n\nfunction ensureLightbox() {\n  if (!lightboxInstance) {\n    lightboxInstance = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n  } else {\n    lightboxInstance.refresh();\n  }\n}\n\nexport function createGallery(images) {\n  if (!Array.isArray(images) || images.length === 0) return;\n\n  const markup = images\n    .map(\n      ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n        `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n          </a>\n          <div class=\"image-stats\">\n            <p class=\"stat\">Likes <span>${likes}</span></p>\n            <p class=\"stat\">Views <span>${views}</span></p>\n            <p class=\"stat\">Comments <span>${comments}</span></p>\n            <p class=\"stat\">Downloads <span>${downloads}</span></p>\n          </div>\n        </li>`\n    )\n    .join('');\n\n  galleryContainer.insertAdjacentHTML('beforeend', markup);\n  ensureLightbox();\n}\n\nexport function clearGallery() {\n  galleryContainer.innerHTML = '';\n  if (lightboxInstance) {\n    lightboxInstance.destroy();\n    lightboxInstance = null;\n  }\n}\n\nexport function showLoader() {\n  if (!loaderEl) return;\n  loaderEl.classList.add(LOADER_ACTIVE_CLASS);\n  loaderEl.setAttribute('aria-hidden', 'false');\n}\n\nexport function hideLoader() {\n  if (!loaderEl) return;\n  loaderEl.classList.remove(LOADER_ACTIVE_CLASS);\n  loaderEl.setAttribute('aria-hidden', 'true');\n}\n\nexport function showLoadMoreButton() {\n  if (!loadMoreBtn) return;\n  loadMoreBtn.classList.remove(HIDDEN_CLASS);\n}\n\nexport function hideLoadMoreButton() {\n  if (!loadMoreBtn) return;\n  loadMoreBtn.classList.add(HIDDEN_CLASS);\n}\n\nexport function getGalleryFirstCardHeight() {\n  const firstItem = galleryContainer.querySelector('.gallery-item');\n  if (!firstItem) return 0;\n  const { height } = firstItem.getBoundingClientRect();\n  return height;\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport getImagesByQuery, { PER_PAGE } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  getGalleryFirstCardHeight,\n} from './js/render-functions.js';\n\nconst form = document.querySelector('.form');\nconst submitBtn = form.querySelector('button[type=submit]');\nconst input = form.querySelector('input[name=\"search-text\"]');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nlet currentQuery = '';\nlet page = 1;\nlet totalHits = 0;\n\nsubmitBtn.disabled = true;\n\ninput.addEventListener('input', evt => {\n  submitBtn.disabled = evt.target.value.trim() === '';\n});\n\nform.addEventListener('submit', async evt => {\n  evt.preventDefault();\n  const searchWord = input.value.trim();\n\n  if (!searchWord) {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please enter a search query',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  currentQuery = searchWord;\n  page = 1;\n  totalHits = 0;\n\n  clearGallery();\n  hideLoadMoreButton();\n  showLoader();\n  submitBtn.disabled = true;\n\n  try {\n    const data = await getImagesByQuery(currentQuery, page);\n    const images = data.hits;\n    totalHits = data.totalHits || 0;\n\n    if (!images.length) {\n      iziToast.error({\n        title: 'No results',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    createGallery(images);\n\n    if (totalHits > page * PER_PAGE) {\n      showLoadMoreButton();\n    } else {\n      hideLoadMoreButton();\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again later.',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n    form.reset();\n    submitBtn.disabled = true;\n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  page += 1;\n  showLoader();\n  hideLoadMoreButton();\n\n  try {\n    const data = await getImagesByQuery(currentQuery, page);\n    const images = data.hits;\n    createGallery(images);\n\n    const loadedItems = page * PER_PAGE;\n    if (loadedItems >= (data.totalHits || totalHits)) {\n      hideLoadMoreButton();\n      iziToast.info({\n        title: 'End',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    } else {\n      showLoadMoreButton();\n    }\n\n    const cardHeight = getGalleryFirstCardHeight();\n    if (cardHeight) {\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n    }\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again later.',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n  }\n});\n"],"names":["BASE_URL","API_KEY","PER_PAGE","getImagesByQuery","query","page","params","url","axios","galleryContainer","loaderEl","loadMoreBtn","LOADER_ACTIVE_CLASS","HIDDEN_CLASS","lightboxInstance","ensureLightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","getGalleryFirstCardHeight","firstItem","height","form","submitBtn","input","currentQuery","totalHits","evt","searchWord","iziToast","data","error","cardHeight"],"mappings":"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"}
